<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>The Void</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { background: black; color: #a00; height: 100vh; display: flex; justify-content: center; align-items: center; font-family: 'Courier New', monospace; overflow: hidden; }
        #text-container { font-size: 3rem; text-align: center; opacity: 0; transition: opacity 2s; text-shadow: 0 0 15px red; }
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: black; display: flex; justify-content: center; align-items: center; z-index: 10; }
        button { padding: 20px 40px; font-size: 1.5rem; background: transparent; color: red; border: 2px solid red; cursor: pointer; transition: 0.2s; }
        button:hover { background: red; color: black; box-shadow: 0 0 20px red; }
    </style>
</head>
<body>
    <div id="overlay"><button id="btn">ENTER IF YOU DARE</button></div>
    <div id="text-container">...</div>

    <script>
        const socket = io();
        const btn = document.getElementById('btn');
        const overlay = document.getElementById('overlay');
        const textEl = document.getElementById('text-container');

        // 1. USER CLICKS BUTTON
        btn.addEventListener('click', () => {
            // Hide the overlay
            overlay.style.display = 'none';
            
            // TELL SERVER WE ARE READY
            console.log("Button clicked. Waking Vecna...");
            socket.emit('wake_vecna');
        });

        // 2. SERVER RESPONDS WITH SCARE
        socket.on('scare_event', (data) => {
            console.log("Scare received");
            
            // Show Text
            textEl.innerText = data.text;
            textEl.style.opacity = 1;

            if (data.audio) {
                const audio = new Audio("data:audio/mp3;base64," + data.audio);
                
                // ðŸ’€ DEMON SETTINGS
                audio.playbackRate = 0.65; 
                audio.preservesPitch = false; 
                if (audio.mozPreservesPitch !== undefined) audio.mozPreservesPitch = false;
                if (audio.webkitPreservesPitch !== undefined) audio.webkitPreservesPitch = false;

                audio.play().catch(e => console.error("Audio blocked:", e));
            }
        });
    </script>
</body>
</html>
